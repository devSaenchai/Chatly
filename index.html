<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Chatly</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial;}

body{
background:#0b141a;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
color:white;
}

.app{
width:100%;
max-width:480px;
height:100vh;
display:flex;
flex-direction:column;
background:#111b21;
}

.header{
background:#202c33;
padding:15px;
text-align:center;
font-size:20px;
font-weight:bold;
}

#messages{
flex:1;
overflow-y:auto;
padding:10px;
display:flex;
flex-direction:column;
}

.message{
max-width:75%;
padding:8px 12px;
margin:6px 0;
border-radius:10px;
word-wrap:break-word;
}

.me{
align-self:flex-start;
background:#005c4b;
}

.other{
align-self:flex-end;
background:#202c33;
}

.username{
font-size:11px;
color:#53bdeb;
font-weight:bold;
}

.input-area{
display:flex;
gap:5px;
padding:10px;
background:#202c33;
}

input{
flex:1;
padding:10px;
border:none;
border-radius:20px;
outline:none;
}

button{
padding:10px;
border:none;
border-radius:20px;
background:#00a884;
color:white;
font-weight:bold;
}

/* Popup */
.popup{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.8);
display:flex;
justify-content:center;
align-items:center;
}

.popup-box{
background:#202c33;
padding:20px;
border-radius:10px;
display:flex;
flex-direction:column;
gap:10px;
width:80%;
max-width:300px;
}
</style>
</head>

<body>

<div class="app">

<div class="header">Chatly</div>

<div id="messages"></div>

<div class="input-area">
<input id="messageInput" placeholder="Type message..." onkeypress="handleEnter(event)">
<button onclick="sendMessage()">Send</button>
</div>

</div>

<!-- Username Popup -->
<div id="usernamePopup" class="popup">
<div class="popup-box">
<h3>Select Username</h3>
<input id="usernameInput" placeholder="Enter username">
<button onclick="saveUsername()">Start Chat</button>
</div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>

<script>

// ðŸ”¥ YOUR FIREBASE CONFIG
const firebaseConfig={
apiKey:"AIzaSyDaoRzu6_cpPxeAjoX6kbsTCUlf5Vpn4Kg",
authDomain:"chatly-2f097.firebaseapp.com",
databaseURL:"https://chatly-2f097-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId:"chatly-2f097",
storageBucket:"chatly-2f097.firebasestorage.app",
messagingSenderId:"632092552334",
appId:"1:632092552334:web:b1390de09936da2516eddf"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.database();

let username="";

// CHECK SAVED USER
window.onload=function(){
const saved=localStorage.getItem("chatly_username");

if(saved){
username=saved;
document.getElementById("usernamePopup").style.display="none";
loadMessages();
}
}

// SAVE USERNAME
function saveUsername(){
const name=document.getElementById("usernameInput").value.trim();
if(name===""){alert("Enter username");return;}

username=name;
localStorage.setItem("chatly_username",name);
document.getElementById("usernamePopup").style.display="none";
loadMessages();
}

// SEND MESSAGE
function sendMessage(){
const input=document.getElementById("messageInput");
const text=input.value.trim();
if(text==="") return;

db.ref("chatly-room").push({
user:username,
text:text,
time:Date.now()
});

input.value="";
}

// ENTER SEND
function handleEnter(e){
if(e.key==="Enter"){sendMessage();}
}

// LOAD MESSAGES
function loadMessages(){

db.ref("chatly-room").off();

db.ref("chatly-room").on("child_added",snap=>{

const msg=snap.val();

const div=document.createElement("div");

div.className="message "+(msg.user===username?"me":"other");

div.innerHTML=
"<div class='username'>"+msg.user+"</div>"+
"<div>"+msg.text+"</div>";

document.getElementById("messages").appendChild(div);

const box=document.getElementById("messages");
box.scrollTop=box.scrollHeight;

});
}

</script>

</body>
</html>
